"use strict";function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(l)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var myMap,myForm=document.querySelector(".order-form"),btnForm=document.querySelector(".order-button__form"),modal=document.querySelector(".modal"),modalMessage=document.querySelector(".modal__text"),btnModalClose=document.querySelector(".modal__btn"),body=document.querySelector(".body"),hamburger=document.querySelector(".hamburger"),navigation=document.querySelector(".navigation"),link=document.querySelectorAll(".navigation__link"),slider=document.querySelector(".reviews-card"),sliderItems=document.querySelectorAll(".reviews-card__item"),sliderList=document.querySelector(".reviews-card__list"),slideControls=document.querySelectorAll(".reviews-control__item"),teamName=document.querySelectorAll(".team__name"),teamList=document.querySelector(".team__list"),teamInfo=document.querySelectorAll(".team__info"),teamListMobile=document.querySelector(".team-mobile__list"),itemLinks=document.querySelectorAll(".menu__link"),btnPlayback=document.querySelector(".player__button-playback"),btnPlay=document.querySelector(".player__playback-icon"),content=document.querySelector(".player__content"),playerBox=document.querySelector(".player__box"),volume=document.querySelector(".player__sound-line"),progress=document.querySelector(".slider-progress"),progressPoint=document.querySelector(".player__progrss-point"),screenPlayer=document.querySelector(".player__splash"),volumePoint=document.querySelector(".player__volume-point"),sections=$("section"),display=document.querySelector(".maincontent");function validateForm(e){var t=!0;return validateField(e.elements.name)||(t=!1),validateField(e.elements.phone)||(t=!1),validateField(e.elements.comment)||(t=!1),t}function validateField(e){return e.checkValidity()?(e.style.outline="",!0):(e.style.outline="3px solid red",!1)}btnForm.addEventListener("click",(function(e){if(e.preventDefault(),validateForm(myForm)){var t={name:myForm.elements.name.value,phone:myForm.elements.phone.value,comment:myForm.elements.comment.value,to:myForm.elements.to.value},a=new XMLHttpRequest;a.responseType="json",a.open("POST","https://webdev-api.loftschool.com/sendmail"),a.setRequestHeader("content-type","application/json"),a.send(JSON.stringify(t)),a.addEventListener("load",(function(){200===a.status?(modal.style.opacity="1",modal.style.zIndex="999999",modalMessage.textContent=a.response.message,body.style.overflowY="hidden",document.body.style.position="fixed",display.style.position="fixed",myForm.reset()):(modal.style.opacity="1",modal.style.zIndex="999999",body.style.overflowY="hidden",document.body.style.position="fixed",modalMessage.textContent="Отправить сообщение не удалось, повторите запрос позже")})),btnModalClose.addEventListener("click",(function(){modal.style.opacity="0",modal.style.zIndex="-9000",body.style.overflow="visible",display.style.overflow="visible"})),window.addEventListener("keydown",(function(e){"Escape"==e.code&&(modal.style.opacity="0",modal.style.zIndex="-9000",body.style.overflow="visible")}))}})),hamburger.addEventListener("click",(function(e){hamburger.classList.toggle("hamburger--active"),navigation.classList.toggle("navigation--active")})),link.forEach((function(e){e.addEventListener("click",(function(){hamburger.classList.contains("hamburger--active")&&(hamburger.classList.remove("hamburger--active"),navigation.classList.remove("navigation--active"))}))}));var init=function(){myMap=new ymaps.Map("map",{center:[55.752004,37.576133],zoom:16,controls:[]});var e=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"../img/icons/marker.svg",iconImageSize:[58,73],iconImageOffset:[-35,-52]});[[55.752004,37.576133]].forEach((function(t){e.add(new ymaps.Placemark(t))})),myMap.geoObjects.add(e)};ymaps.ready(init);var player,getItemWidth=function(e){var t=524,a=window.innerWidth,n=e.offsetWidth,r=window.matchMedia("(max-width: 768px)").matches,i=window.matchMedia("(max-width: 480px)").matches;return r&&(t=a-n*itemLinks.length),i&&(t=a-n),t},setItemWidth=function(e,t){e.nextElementSibling.style.width="".concat(t,"px")},closeItem=function(e){e.parentElement.classList.remove("menu__item--active"),e.classList.remove("menu__link--active"),setItemWidth(e,0)},openItem=function(e){e.parentElement.classList.add("menu__item--active"),e.classList.add("menu__link--active");var t=getItemWidth(e);setItemWidth(e,t)};function onYouTubeIframeAPIReady(){player=new YT.Player("yt-player",{height:"392",width:"662",videoId:"6CSfkB4_m78",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:1,showinfo:0,rel:0,autoplay:0,modestbranding:1}})}itemLinks.forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault();var a=t.target,n=a.classList.contains("menu__link--active"),r=document.querySelector(".menu__link--active");a.classList.contains("menu__link")&&n&&r&&closeItem(e),a.classList.contains("menu__link")&&!n&&(r&&itemLinks.forEach((function(e){closeItem(e)})),openItem(e))}))})),window.addEventListener("resize",(function(){var e=document.querySelector(".menu__link--active");e&&closeItem(e)}));var eventInit=function(){btnPlay.addEventListener("click",(function(e){e.preventDefault();var t=btnPlay.firstChild;btnPlay.hasAttribute("data-playback")?(t.nextSibling.setAttribute("xlink:href","img/icons/sprite.svg#pause"),btnPlay.removeAttribute("data-playback"),playerBox.classList.add("player__box--active"),player.playVideo()):(btnPlay.setAttribute("data-playback","1"),t.nextSibling.setAttribute("xlink:href","img/icons/sprite.svg#play"),playerBox.classList.remove("player__box--active"),player.pauseVideo())}))};function onPlayerReady(){updateProgressBar(),clearInterval(e);var e=setInterval((function(){updateProgressBar()}),1e3)}var onPlayerStateChange=function(){content.addEventListener("click",(function(e){e.preventDefault();var t=btnPlay.firstChild;player.getPlayerState(),t.nextSibling.setAttribute("xlink:href","img/icons/sprite.svg#pause"),btnPlay.removeAttribute("data-playback"),playerBox.classList.add("player__box--active"),player.playVideo(),2===player.getPlayerState()&&(btnPlay.setAttribute("data-playback","1"),t.nextSibling.setAttribute("xlink:href","img/icons/sprite.svg#play"),playerBox.classList.remove("player__box--active"),player.pauseVideo())}))};function updateProgressBar(){var e=Math.round(player.getCurrentTime()/player.getDuration()*100);progress.setAttribute("value",e),progressPoint.style.left="".concat(e-1.5,"%"),progress.style.setProperty("--value",e)}content.addEventListener("click",(function(e){e.preventDefault();var t=btnPlay.firstChild;player.getPlayerState(),t.nextSibling.setAttribute("xlink:href","img/icons/sprite.svg#pause"),btnPlay.removeAttribute("data-playback"),playerBox.classList.add("player__box--active"),player.playVideo()})),progress.addEventListener("click",(function(e){e.preventDefault();var t=player.getDuration()*(e.target.value/100);player.seekTo(t),5===player.getPlayerState()&&player.pauseVideo()})),volumePoint.style.left="42%",volume.addEventListener("click",(function(e){e.preventDefault();var t=e.target.value/100*100;player.setVolume(t),volume.style.setProperty("--value",t+5),volumePoint.style.left="".concat(t-8,"%")}));var _step,_iterator=_createForOfIteratorHelper(document.querySelectorAll(".slider-progress"));try{var _loop=function(){var e=_step.value;e.style.setProperty("--value",50),e.style.setProperty("--min",""==e.min?"0":e.min),e.style.setProperty("--max",""==e.max?"100":e.max),e.addEventListener("input",(function(){return e.style.setProperty("value",e.value)}))};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(e){_iterator.e(e)}finally{_iterator.f()}eventInit();var sliderCount=0,sliderWidth=slider.offsetWidth;function rollSlider(){sliderList.style.transform="translateX(".concat(-sliderCount*sliderWidth,"px)")}function thisSlide(e){slideControls.forEach((function(e){return e.classList.remove("reviews-control__item--active")})),slideControls[e].classList.add("reviews-control__item--active")}$(".reviews-control__link").on("click",(function(e){e.preventDefault()})),slideControls.forEach((function(e,t){e.addEventListener("click",(function(){sliderCount=t,rollSlider(),thisSlide(sliderCount)}))}));var mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1;display.firstElementChild.classList.add("active");var transition=function(e){if(!1===inScroll){inScroll=!0;var t=-100*e,a=sections.eq(e).attr("data-color-scheme"),n=$(".pagination__list"),r=$(".hamburger");"black"===a?(n.addClass("pagination__list-color--black"),r.addClass("hamburger-color--black")):(n.removeClass("pagination__list-color--black"),r.removeClass("hamburger-color--black")),display.style.transform="translateY(".concat(t,"%)"),sections.eq(e).addClass("active").siblings().removeClass("active"),setTimeout((function(){inScroll=!1,n.find(".pagination__item").eq(e).addClass("pagination__link--active").siblings().removeClass("pagination__link--active")}),1300)}},viewportScroll=function(e){var t=sections.filter(".active"),a=t.next(),n=t.prev();"next"===e&&a.length&&transition(a.index()),"prev"===e&&n.length&&transition(n.index())};function accordionTeam(){teamList.addEventListener("click",(function(e){var t=e.target;if(t.classList.contains("team__name")){var a,n=t.parentNode,r=t.nextElementSibling,i=r.firstElementChild.clientHeight,o=_createForOfIteratorHelper(teamInfo);try{for(o.s();!(a=o.n()).done;){var l=a.value;l!==n&&(l.classList.remove("team__item--active"),l.lastElementChild.style.height=0)}}catch(e){o.e(e)}finally{o.f()}n.classList.contains("team__item--active")?(n.classList.remove("team__item--active"),r.style.height=0):(n.classList.add("team__item--active"),r.style.height=i+"px")}}))}function accordionTeamMobile(){teamListMobile.addEventListener("click",(function(e){var t=e.target;if(t.classList.contains("team__name")){var a,n=t.parentNode,r=t.nextElementSibling,i=r.firstElementChild.clientHeight,o=_createForOfIteratorHelper(teamInfo);try{for(o.s();!(a=o.n()).done;){var l=a.value;l!==n&&(l.classList.remove("team__item--active"),l.lastElementChild.style.height=0)}}catch(e){o.e(e)}finally{o.f()}n.classList.contains("team__item--active")?(n.classList.remove("team__item--active"),r.style.height=0):(n.classList.add("team__item--active"),r.style.height=i+"px")}}))}window.addEventListener("wheel",(function(e){var t=e.deltaY;t>0&&viewportScroll("next"),t<0&&viewportScroll("prev")})),window.addEventListener("keydown",(function(e){var t=e.target.tagName.toLowerCase();if("input"!==t&&"textarea"!==t)switch(e.code){case"ArrowUp":viewportScroll("prev");break;case"ArrowDown":viewportScroll("next")}})),$("[data-scroll-to]").on("click",(function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-scroll-to"),a=$("[data-section-id=".concat(t,"]"));transition(a.index())})),isMobile&&$((function(){$("body").swipe({swipe:function(e,t){var a="";"up"===t&&(a="next"),"down"===t&&(a="prev"),viewportScroll(a)}})})),$(".single-item").slick({infinite:!0,speed:600,cssEase:"linear",swipe:!0,prevArrow:'<button type="button" class="slider__arrow slider__arrow--left"></button>',nextArrow:'<button type="button" class="slider__arrow slider__arrow--right"></button>'}),teamName.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault()}))})),accordionTeam(),accordionTeamMobile();